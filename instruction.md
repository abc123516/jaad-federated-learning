# 基于JAAD数据集的横向联邦学习态势感知项目

## 项目概述

本项目旨在利用JAAD（Joint Attention in Autonomous Driving）数据集，通过横向联邦学习策略训练行人行为预测模型。同时，模拟边缘计算场景下的态势感知，包括节点故障处理及动态任务调整。

## 数据说明

- **JAAD_clips/**：原始视频数据集
- **JAAD-JAAD_2.0/**：标注数据结构
  - annotations/：基本标注信息
  - annotations_appearance/：行人外观标注
  - annotations_attributes/：行人属性标注
  - annotations_traffic/：交通场景标注
  - annotations_vehicle/：车辆信息标注
  - split_ids/：数据集划分信息

## 联邦学习架构

本项目采用横向联邦学习（Horizontal Federated Learning）架构，即各边缘节点拥有相同特征空间但不同样本的数据分布。

### 边缘计算节点配置

模拟三个边缘计算节点，具体配置如下：

#### 边缘节点1
- 模型架构：ResNet-50 + GRU
- 功能：使用ResNet-50进行视频特征提取，GRU完成时序建模
- 数据分配：JAAD数据集的33%

#### 边缘节点2
- 模型架构：MobileNetV3 + LSTM
- 功能：使用MobileNetV3轻量化网络提取特征，LSTM进行时间序列分析
- 数据分配：JAAD数据集的33%

#### 边缘节点3
- 模型架构：EfficientNet + Transformer
- 功能：使用EfficientNet提取空间特征，Transformer处理时序关系
- 数据分配：JAAD数据集的34%

## 态势感知模拟

### 故障模拟策略

1. **节点中断模拟**：在训练过程中随机中断一个边缘节点，模拟设备故障
2. **通信延迟模拟**：引入随机通信延迟，模拟网络波动
3. **计算资源波动**：动态调整计算资源分配，模拟边缘设备负载变化

### 态势感知评估指标

实时监测以下性能指标：
- 计算负载（CPU/GPU利用率）
- 模型推理时延
- 节点通信开销
- 预测准确率
- 能源消耗

## 联邦学习实施流程

1. **数据预处理与分割**
   - 将JAAD_clips视频数据按预定义划分（见split_ids目录）
   - 为三个边缘节点分配不同子集

2. **模型训练**
   - 本地训练：各节点独立训练本地模型
   - 参数聚合：中央服务器聚合模型参数
   - 模型更新：将聚合后的参数分发至各节点

3. **故障处理**
   - 节点故障检测
   - 任务动态迁移
   - 模型参数恢复

4. **结果融合**
   - 设计动态权重调整策略
   - 根据节点性能指标调整预测结果融合权重

## 实验验证

1. **基线比较**：与集中式训练方法对比
2. **鲁棒性测试**：在不同故障情景下评估系统表现
3. **效率分析**：评估联邦学习在边缘计算环境中的通信和计算效率

## 技术路线

```
数据预处理 → 节点初始化 → 联邦训练 → 态势感知 → 节点故障处理 → 结果融合 → 性能评估
```

## 预期成果

1. 基于横向联邦学习的行人行为预测模型
2. 边缘计算环境下的态势感知机制
3. 节点故障响应与恢复策略
4. 分布式模型训练与融合的性能评估 